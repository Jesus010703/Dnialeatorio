<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Consulta DNI</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #0e2f44;
        color: white;
        text-align: center;
        padding: 20px;
    }
    input {
        padding: 10px;
        font-size: 18px;
        width: 200px;
        border-radius: 5px;
        border: none;
        margin-right: 10px;
    }
    button {
        background: #ff6600;
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        border-radius: 5px;
        margin: 5px;
    }
    button:hover {
        background: #e05500;
    }
    pre {
        background: #1a4a61;
        padding: 15px;
        border-radius: 5px;
        text-align: left;
        max-width: 600px;
        margin: 20px auto;
        white-space: pre-wrap;
        word-break: break-word;
    }
</style>
</head>
<body>

<h1>Consulta de DNI</h1>
<input type="text" id="dni" placeholder="Ingrese DNI">
<button id="btnConsultar">Consultar</button>
<button id="btnAleatorio">DNI Aleatorio</button>
<pre id="resultado">Aqu√≠ aparecer√°n los datos...</pre>

<script>
const API_URL = "https://api.consultasperu.com/api/v1/query";
const TOKEN = "605db0be586491e0baf1279db67bddbe57d7a04353030c10e649677bc44a5d0e"; // Reemplaza con tu token real

// Funci√≥n para generar un DNI v√°lido con Luhn que empiece con 1, 4 o 7
function generarDNI() {
    const prefijos = ["1", "4", "7"];
    let numero = prefijos[Math.floor(Math.random() * prefijos.length)];
    while (numero.length < 7) {
        numero += Math.floor(Math.random() * 10);
    }
    numero += calcularDigitoLuhn(numero);
    return numero;
}

// Algoritmo de Luhn
function calcularDigitoLuhn(numero) {
    let suma = 0;
    let invertir = true;
    for (let i = numero.length - 1; i >= 0; i--) {
        let digito = parseInt(numero[i]);
        if (invertir) {
            digito *= 2;
            if (digito > 9) digito -= 9;
        }
        suma += digito;
        invertir = !invertir;
    }
    return (10 - (suma % 10)) % 10;
}

// Funci√≥n para mostrar datos en espa√±ol
function mostrarDatosEnEspanol(data) {
    if (!data.success || !data.data) {
        return "‚ùå No se encontraron datos para este DNI.";
    }

    const d = data.data;
    return `
üìÑ DNI: ${d.number}
üë§ Nombre completo: ${d.full_name}
üìù Nombres: ${d.name}
üìù Apellidos: ${d.surname}
üî¢ C√≥digo de verificaci√≥n: ${d.verification_code}
üë®‚Äçüë©‚Äçüëß Primer apellido: ${d.first_last_name}
üë®‚Äçüë©‚Äçüëß Segundo apellido: ${d.second_last_name}
üéÇ Fecha de nacimiento: ${d.date_of_birth}
‚öß G√©nero: ${d.gender}
üèô Departamento: ${d.department}
üèõ Provincia: ${d.province}
üèò Distrito: ${d.district}
üìç Direcci√≥n: ${d.address}
üìç Direcci√≥n completa: ${d.address_complete}
üåê Ubigeo: ${d.ubigeo}
üåê Ubigeo SUNAT: ${d.ubigeo_sunat}
    `.trim();
}

// Funci√≥n para consultar la API
async function consultarAPI(dni) {
    document.getElementById("resultado").textContent = "üîÑ Consultando...";
    
    let respuesta = await fetch(API_URL, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            token: TOKEN,
            type_document: "dni",
            document_number: dni
        })
    });
    
    let data = await respuesta.json();
    document.getElementById("resultado").textContent = mostrarDatosEnEspanol(data);
}

// Evento para bot√≥n de consulta manual
document.getElementById("btnConsultar").addEventListener("click", () => {
    let dni = document.getElementById("dni").value.trim();
    if (dni) {
        consultarAPI(dni);
    } else {
        alert("Por favor, ingrese un DNI.");
    }
});

// Evento para bot√≥n de DNI aleatorio
document.getElementById("btnAleatorio").addEventListener("click", () => {
    let dniAleatorio = generarDNI();
    document.getElementById("dni").value = dniAleatorio;
    consultarAPI(dniAleatorio);
});
</script>

</body>
</html>
